<ion-content [fullscreen]="true">
  <div class="login-wrapper">

    <!-- ==== LEFT COLUMN: PASSWORD RECOVERY FORM ==== -->
    <div class="login-left">

      <!-- Logo Placeholder -->
      <div class="logo-box"></div>

      <!-- Page Title -->
      <h2 class="page-title">Forgot Password</h2>

      <!-- ==== STEP 1: EMAIL VERIFICATION ==== -->
      <div *ngIf="stage === 'email'">
        <ion-item>
          <ion-input
            label="Email"
            labelPlacement="floating"
            type="email"
            [(ngModel)]="email"
            required>
          </ion-input>
        </ion-item>

        <ion-button expand="block" fill="outline" (click)="validateEmail()">
          Continue
        </ion-button>
      </div>

      <!-- ==== STEP 2: SECURITY QUESTION ==== -->
      <div *ngIf="stage === 'question'">
        <p class="question-label">Security Question:</p>
        <p class="question-text">
          <strong>{{ question || 'No question found.' }}</strong>
        </p>

        <ion-item>
          <ion-input
            label="Secret Answer"
            labelPlacement="floating"
            [(ngModel)]="secretAnswer">
          </ion-input>
        </ion-item>

        <ion-button expand="block" fill="outline" (click)="validateAnswer()">
          Submit Answer
        </ion-button>
      </div>

      <!-- ==== STEP 3: RESET PASSWORD ==== -->
      <div *ngIf="stage === 'reset'">

        <!-- New Password -->
        <ion-item lines="full">
          <ion-input
            [type]="showPassword ? 'text' : 'password'"
            label="New Password"
            labelPlacement="floating"
            [(ngModel)]="newPassword">
          </ion-input>
          <ion-buttons slot="end">
            <ion-button fill="clear" size="small" (click)="togglePasswordVisibility()">
              <ion-icon [name]="showPassword ? 'eye-off' : 'eye'"></ion-icon>
            </ion-button>
          </ion-buttons>
        </ion-item>

        <!-- Confirm New Password -->
        <ion-item>
          <ion-input
            [type]="showConfirmPassword ? 'text' : 'password'"
            label="Confirm Password"
            labelPlacement="floating"
            [(ngModel)]="confirmPassword">
          </ion-input>
          <ion-buttons slot="end">
            <ion-button fill="clear" size="small" (click)="toggleConfirmPasswordVisibility()">
              <ion-icon [name]="showConfirmPassword ? 'eye-off' : 'eye'"></ion-icon>
            </ion-button>
          </ion-buttons>
        </ion-item>

        <ion-button expand="block" fill="outline" (click)="resetPassword()">
          Reset Password
        </ion-button>
      </div>
    </div>

    <!-- ==== STEP 4: SUCCESS MESSAGE ==== -->
    <div *ngIf="resetSuccess" class="success-message-box">
      <ion-icon name="checkmark-circle" color="success"></ion-icon>
      <h3 class="success-title">Password reset successfully!</h3>
      <p class="success-subtitle">You can now log in with your new password.</p>

      <ion-button color="danger" expand="block" fill="solid" (click)="goToLogin()">
        Log in
      </ion-button>
    </div>

    <!-- ==== RIGHT COLUMN: IMAGE + MOTIVATIONAL SLOGAN ==== -->
    <div class="login-right">
      <div class="hero-text">YOUR TIME. YOUR WOD</div>
    </div>

  </div> <!-- End of .login-wrapper -->
</ion-content>
